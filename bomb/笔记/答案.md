# bomb lab´ğ°¸

### °ÑÏÂÁĞÎÄ×Ö¸´ÖÆµ½Ò»¸ötxtÎÄ¼ş, eg answer.txt, È»ºóÔËĞĞbomb: ./bomb answer.txt, ¼´¿É³É¹¦½â±¬Õ¨µ¯
Border relations with Canada have never been better.
1 2 4 8 16 32
7 327
3 0
IONEFG
4 3 2 1 6 5

## µÚÒ»¸ö
- Õâ¸ö¾ÍÊÇÒªÄãÊäÈëÒ»´®×Ö·û, °ÑÕâ´®×Ö·ûºÍ¶ş½øÖÆÎÄ¼şÀïÃæ´¢´æµÄ×Ö·û±È½Ï.
- `sscanf`:Èı¸ö²ÎÊı, µÚÒ»¸öÊÇsource×Ö·û´®, µÚ¶ş¸öÊÇformat×Ö·û´®, µÚÈı¸öÊÇdestµÄµØÖ·. ÀıÈç`sscanf("12 32 21","%d %d %d",0x123456)` , Ç°Á½¸ö×Ö·û´®¿ÉÒÔÊÖ¶¯Ğ´, Ò²¿ÉÒÔ°Ñ×Ö·û´®µÄÊ×µØÖ·ÊäÈë.
- ÀïÃæ´¢´æµÄ×Ö·û¿ÉÒÔÕÒµ½Ê×µØÖ·ºóÔÚgdbÓÃ `x/`ÃüÁîÏÔÊ¾³öÀ´

### ´ğ°¸:¡¾Border relations with Canada have never been better.¡¿

## µÚ¶ş¸ö
![avatar](pics/phase_2.png)
Õâ¸ö¶Á6¸öÊı×Ö, È»ºóµÚÒ»¸öÊı×ÖÒªºÍ1ÏàÍ¬, ÆäÓàÊı×Ö¶¼ÊÇÇ°Ò»¸öÊı×ÖµÄÁ½±¶, ËùÒÔ½á¹ûÊÇÕâÑù
### ´ğ°¸:¡¾1 2 4 8 16 32¡¿

## µÚÈı¸ö
¾ßÌåÍüÁËÊÇÊ²Ã´ÁË, Ã»ÓĞÁôÏÂÉî¿ÌµÄÓ¡Ïó. Ö±½Ó±©Á¦¶Á»ã±àÒ»²½Ò»²½×öµÄ.
### ´ğ°¸

¡¾0 207¡¿

¡¾1 311¡¿

¡¾2 707¡¿

¡¾3 256¡¿

¡¾4 389¡¿

¡¾5 206¡¿

¡¾6 682¡¿

¡¾7 327¡¿

## µÚËÄ¸ö
Õâ¸öphase±È½ÏÁîÈËÓ¡ÏóÉî¿Ì. ÀïÃæÓĞÒ»¸öÈı¸ö·ÖÖ§µÄµİ¹é, Êµ¼ÊÉÏÓĞÒ»¸öµİ¹éÊÇÎŞĞ§µÄ. Òò´Ë, °ÑËùÓĞµÄ½øÈëÎŞĞ§µİ¹éµÄÅÅ³ıµô, ÓĞ¿ÉÄÜ´æÔÚµÄÈ¡Öµ´úÈë³¢ÊÔ¼´¿É.
    
```cpp

    #include "stdio.h"
    short rdi, rsi, rdx, rcx, rax;
    void func4()
    {
        if (rdx < rsi)
            rcx = (rdx - rsi + 1) / 2 + rsi;
        else
            rcx = (rdx - rsi) / 2 + rsi;
        if (rcx == rdi)
        {
            rax = 0;
            return;
        }
        if (rcx < rdi)//½øÈëÕâ¸öÑ­»·¾ÍÃ»Ï·ÁË£¬·µ»ØÖµ±ØÈ»²»¿ÉÄÜÊÇ0. Èç¹ûÕâ¸öµİ¹éÀïÃæ·µ»ØµÄ²»ÊÇ0, ËùÓĞµÄµİ¹é½áÊøºó±ØÈ»rax²»ÊÇ0
        {
            rsi = rcx + 1;
            func4();
            rax = 2 * rax + 1;
            return;
        }
        if (rcx > rdi)
        {
            rdx = rcx - 1;
            func4();
            rax *= 2;
            return;
        }
    }

    int main()
    {
        int x;
        x = 2;
        rdi = x;
        rsi = 0;
        rdx = 14;
        func4();
        printf("%d\n", rax);
        return 0;
    }
```

### ´ğ°¸
¡¾7 0¡¿

¡¾1 0¡¿

¡¾3 0¡¿

¡¾0 0¡¿

## µÚÎå¸ö
- Ä¿±ê×Ö·û´®ÊÇflyers, ASCIIÂë(decimal)Îª:102 108 121 101 114 115
Õâ¸öÊÇÔÚ³ÌĞò´úÂëÀïÃæ´æÁËÒ»¸öflyers×Ö·û´®ÓÃÀ´¶Ô±È, È»ºóÓĞÒ»¸öµØÖ·¸øÄã, ¼ÇÎªaddr. ÄãÊäÈëµÄ6¸ö×Ö·ûµÄASCII+addr×÷ÎªaddrNew, °Ñ´ÓaddrNew¶ÁÈ¡µÄ×Ö·ûºÍflyersÀïÃæµÄ×Ö·û¶Ô±È, Ò»Ñù²ÅĞĞ. ËùÒÔÒ²¾ÍÊÇËµÕâ¸öphaseµÄºËĞÄÊÇ×¢Òâµ½addr
- Õâ¸öÌâÒ»¿ªÊ¼µÄÊ±ºòÎÒÔÚaddr´ú±íµÄ×Ö·û´®ÀïÃæÑ¡µÄÎ»ÖÃ¶¼ÊÇ¿¿Ç°µÄ, È»ºóÓÃ¿¿Ç°µÄ×ÖÄ¸µÄÔÚaddr×Ö·ûÊı×éÀïµÄĞòºÅ×÷ÎªÊäÈë×Ö·û´®µÄASCIIÂë,
  ½á¹ûÊÇÒ»¶ÑÎŞ·¨ÏÔÊ¾µÄ×Ö·û´®.
- ºóÀ´ÎÒÍùºóÃæÕÒ, ÊÔÍ¼Ê¹ÓÃÄÇĞ©ÄÜ¹»´òÓ¡µÄĞòºÅÀ´×÷Îª´ğ°¸, µ«ÊÇ·¢ÏÖÊ§°ÜÁË, Õ¨µ¯±¬Õ¨
- ÔÚÍøÉÏ²éÁË²é, ÓÖ¼ì²éÁËÏÂ×Ô¼ºµÄ´úÂë, ²Å·¢ÏÖÊäÈëµÄ×Ö·û´®µÄASCIIÂëÖ»ÓĞ×îºóÃæµÄ4 bits±»Ê¹ÓÃÁË. ËùÒÔÓÃ»§ÊäÈëµÄ×Ö·û´®µÄASCIIÖ»ÓĞÔÚ15Ö®ÄÚ²Å»áÓĞĞ§. »òÕßÓÃÄÇĞ©lower 4 bitsºÍµÚÒ»¸ö´ğ°¸µÄASCIIÒ»ÑùµÄÒ²¿ÉÒÔ.
  
![avatar](pics/hidden_string.png)
ÕâÊÇaddr´¦µÄ×Ö·û´®

### ´ğ°¸:
¡¾	¡¿(ÎŞ·¨ÏÔÊ¾µÄASCII) 

ASCII·Ö±ğÊÇ09 0f 0e 05 06 07

°ÑÇ°4¸öbit¸Ä³É4, ´Ó¶øµÃµ½¿ÉÏÔÊ¾×Ö·û, ´ğ°¸2:

¡¾IONEFG¡¿

ÆäÓà»¹ÓĞºÜ¶à, ¾Í²»Ò»Ò»ÁĞ³ö

## µÚÁù¸ö

Õâ¸ö´úÂëµÄ¹ı³ÌÊÇ, ÏÈ¶ÁÈë6¸öÊı×Ö
1. Õâ6¸öÊı×Ö¶¼ÒªĞ¡ÓÚµÈÓÚ6
2. Õâ6¸öÊı×Ö²»ÄÜÏàµÈ
3. Õâ6¸öÊı×Ö±ä³É7-self
4. `0x6032d0`ÊÇµÚÒ»¸önodeµÄµØÖ·, ÕâĞ©node¶¼ÊÇ´æ·ÅÒ»¸ö64bitÖµ(`value`), È»ºóÊÇÒ»¸ö64bitµØÖ·(`next`), Ö¸ÏòÏÂÒ»¸önode. 6¸önodeÔÚÄÚ´æÀïÃæÊÇË³Ğò½ô°¤×Å´æ·ÅµÄ, ·Ö±ğ¼ÇÎªnode_1µ½6.
5. ¸Ä±äºóµÄ6¸öÊı×Ö, ÆäÖĞµÚi¸öÊı×ÖÊÇj,ÄÇÃ´¾Í°Ñnode_j·Åµ½Ò»¸ö6ÔªËØÖ¸ÕëÊı×éµÄµÚi¸öÎ»ÖÃ. (ÓÉ´Ë¿ÉÒÔ¿´³öÊı×ÖÖ»ÄÜÔÚ1-6ÀïÃæÑ¡)
6. ¼ÙÉèÖ¸ÕëÊı×éÀïÃæµÄnodeµÄË³ĞòÊÇnode_i1µ½i6, È»ºóÁí`node_i1->next = node_i2`, `node_i2 -> next = node_i3`, etc, °ÑÕâÁù¸ö°´ÕÕÔÚÖ¸ÕëÊı×éÀïÃæµÄÎïÀíµÄÎ»ÖÃË³Ğò, Á¬½ÓÆğÀ´
7. ÒªÇó`node_i1 -> value > node_i2 -> value`, ÒÔ´ËÀàÍÆ. ÎªÁËÊµÏÖÕâÒ»µã, ¸Ä±ä6¸öÊı×ÖµÄÊäÈëË³Ğò¼´¿É.

### ´ğ°¸
¡¾4 3 2 1 6 5¡¿

